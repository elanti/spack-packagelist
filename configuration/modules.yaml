modules:
  enable : ['tcl', 'lmod']
  prefix_inspections:
    bin:
      - PATH
    bin64:
      - PATH
    man:
      - MANPATH
    lib:
      - LD_LIBRARY_PATH
    lib64:
      - LD_LIBRARY_PATH
    lib/pkgconfig:
      - PKG_CONFIG_PATH
    lib64/pkgconfig:
      - PKG_CONFIG_PATH
    '':
      - CMAKE_PREFIX_PATH
  tcl:
  # Intel tcl module is needed to add compiler in spack.<release>.compilers
    intel:
      environment:
        set:
          CC: icc
          CXX: icpc
          FC: ifort
          F90: ifort
          F77: ifort
          ICCCFG: /ssoft/spack/external/intel/config/2016/compilers_and_libraries_2016.3.210/icl.cfg
          ICPCCFG: /ssoft/spack/external/intel/config/2016/compilers_and_libraries_2016.3.210/icl.cfg
          IFORTCFG: /ssoft/spack/external/intel/config/2016/compilers_and_libraries_2016.3.210/icl.cfg
        prepend_path:
          PATH: '/ssoft/spack/external/intel/2016/vtune_amplifier_xe_2016.3.0.463186/bin64:/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/bin/intel64:/ssoft/spack/lafnetscha/opt/spack/x86_E5v1_IntelIB/gcc-4.4.7/binutils-2.26-cwd2djeg3mu6sngjnb5uulbhfszvr6su/bin'
          LD_LIBRARY_PATH: '/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/compiler/lib/intel64:/ssoft/spack/external/intel/2016/vtune_amplifier_xe_2016.3.0.463186/lib64:/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/lib/intel64:/ssoft/spack/lafnetscha/opt/spack/x86_E5v1_IntelIB/gcc-4.4.7/binutils-2.26-cwd2djeg3mu6sngjnb5uulbhfszvr6su/lib'
          MANPATH: /ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/man/common
          CPATH: '/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/compiler/include:/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64'
  lmod:
    hash_length: 0
    whitelist: [
      'gcc',
      'llvm',
      'intel',
      'cmake',
      'autoconf',
      'automake',
      'libtool',
      'm4',
      'matlab',
      'cuda',
      'git',
      'tmux']
    blacklist: [
      '%gcc@4.4.7',
      'autoconf',
      'automake',
      'libtool',
      'm4',
      'py-nose',
      'py-setuptools',
      'py-numpy',
      'py-scipy',
      'py-matplotlib',
      'py-pip',
      'py-dateutil',
      'py-funcsigs',
      'py-mock',
      'py-pbr',
      'py-pyparsing',
      'py-pytz',
      'py-matplotlib',
      'py-cython',
      'py-qutip',
      'py-scipy',
      'py-six',
      'py-psycopg2']
    core_compilers: ['gcc@4.4.7']
    hierarchical_scheme: ['lapack']
    all:
      suffixes:
        +mpi: mpi
        +openmp: openmp
        '^fftw+openmp': openmp
      environment:
        set:
          '{name}_ROOT': '{prefix}'
    cuda:
      environment:
        set:
          CUDA_LIBRARY: /ssoft/spack/lafnetscha/opt/spack/x86_E5v2_Mellanox_GPU/gcc-4.4.7/cuda-7.5.18-ob4oee2pngue3l7ygnwiy7wme7rlgrew/lib64
          CUDA_INCLUDE: /ssoft/spack/lafnetscha/opt/spack/x86_E5v2_Mellanox_GPU/gcc-4.4.7/cuda-7.5.18-ob4oee2pngue3l7ygnwiy7wme7rlgrew/include
    gcc:
      environment:
        set:
         CC: gcc
         CXX: g++
         FC: gfortran
         F90: gfortran
         F77: gfortran
    llvm:
      environment:
        set:
          CC: clang
    openmpi:
      environment:
        set:
          SLURM_MPI_TYPE: pmi2
          OMPI_MCA_btl_openib_warn_default_gid_prefix: '0'
    intel:
      environment:
        set:
          CC: icc
          CXX: icpc
          FC: ifort
          F90: ifort
          F77: ifort
          AMPLXE_ROOT: /ssoft/spack/external/intel/2016/vtune_amplifier_xe_2016.3.0.463186
          ICCCFG: /ssoft/spack/external/intel/config/2016/compilers_and_libraries_2016.3.210/icl.cfg
          ICPCCFG: /ssoft/spack/external/intel/config/2016/compilers_and_libraries_2016.3.210/icl.cfg
          IFORTCFG: /ssoft/spack/external/intel/config/2016/compilers_and_libraries_2016.3.210/icl.cfg
        prepend_path:
          PATH: '/ssoft/spack/external/intel/2016/vtune_amplifier_xe_2016.3.0.463186/bin64:/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/bin/intel64:/ssoft/spack/lafnetscha/opt/spack/x86_E5v1_IntelIB/gcc-4.4.7/binutils-2.26-cwd2djeg3mu6sngjnb5uulbhfszvr6su/bin'
          LD_LIBRARY_PATH: '/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/compiler/lib/intel64:/ssoft/spack/external/intel/2016/vtune_amplifier_xe_2016.3.0.463186/lib64:/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/lib/intel64:/ssoft/spack/lafnetscha/opt/spack/x86_E5v1_IntelIB/gcc-4.4.7/binutils-2.26-cwd2djeg3mu6sngjnb5uulbhfszvr6su/lib'
          MANPATH: /ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/man/common
          CPATH: '/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/compiler/include:/ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/compiler/include/intel64'
    intelmpi: # Default for Intel MPI
      environment:
        set:
          I_MPI_ROOT: /ssoft/spack/external/intel/2016/impi/5.1.3.210
          I_MPI_FABRICS: 'shm:tmi'
          IPATH_NO_CPUAFFINITY: '1'
          I_MPI_PMI_LIBRARY: /usr/lib64/libpmi.so
          MPICC: mpiicc
          MPICXX: mpiicpc
          MPIF90: mpiifort
          MPIF77: mpiifort
          MPIFC: mpiifort
    'intelmpi arch=x86_E5v2_Mellanox_GPU:': # Weird syntax, but double colon means override
      environment:
        set:
          I_MPI_ROOT: /ssoft/spack/external/intel/2016/impi/5.1.3.210
          I_MPI_FABRICS: 'shm:ofa'
          IPATH_NO_CPUAFFINITY: '1'
          I_MPI_PMI_LIBRARY: /usr/lib64/libpmi.so
          MPICC: mpiicc
          MPICXX: mpiicpc
          MPIF90: mpiifort
          MPIF77: mpiifort
          MPIFC: mpiifort
    'intelmpi arch=x86_E5v2:':
      environment:
        set:
          I_MPI_ROOT: /ssoft/spack/external/intel/2016/impi/5.1.3.210
          I_MPI_FABRICS: 'shm:tcp'
          IPATH_NO_CPUAFFINITY: '1'
          I_MPI_PMI_LIBRARY: /usr/lib64/libpmi.so
          MPICC: mpiicc
          MPICXX: mpiicpc
          MPIF90: mpiifort
          MPIF77: mpiifort
          MPIFC: mpiifort
    mkl:
      environment:
        set:
          MKLROOT: /ssoft/spack/external/intel/2016/compilers_and_libraries_2016.3.210/linux/mkl
    'hdf5~mpi+cxx':
      environment:
        set:
          HDF5_CC: h5cc
          HDF5_CXX: 'h5c++'
          HDF5_FC: h5fc
    'hdf5+mpi~cxx':
      environment:
        set:
          HDF5_CC: h5pcc
          HDF5_FC: h5pfc
